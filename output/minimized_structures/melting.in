units       metal 
dimension   2 
boundary    p p p 
newton      on 
atom_style  atomic 
#read_data   graphene.dat
fix         f2d all enforce2d
pair_style  airebo 3.0 1 1 
pair_coeff  * * CH.airebo C  
timestep    0.0001

# Calculations
compute     peatom all pe/atom
compute pe  all reduce sum c_peatom
# ---
variable    ke equal ke
variable    s equal step
variable    T equal temp
variable    E equal etotal
variable    PEatom equal c_pe/count(all)
variable    Tdamp equal $(100.0*dt) # Avoid wild fluctuations by choosing appropriate damping

# Output
fix         stats all print     10000 "${s} ${T} ${E} ${ke} ${PEatom}" file energy.txt screen no
dump        melting  all atom   10000 graphene.lammpstrj
dump        vel all  custom      10000 velocities.txt id vx vy vz
dump_modify melting  scale no  
dump_modify melting  sort id
dump_modify vel sort id

# Equilibration - create initial Maxwellian velocities at 50 K
velocity    all create 300.0 12345 mom yes rot yes dist gaussian
fix         1 all nvt temp 300.0 300.0 ${Tdamp}
run         100000
unfix       1

# 1: HEAT TO 7000 K
fix         1 all nvt temp 50.0 8150.0 ${Tdamp}
run         1000000
unfix       1

# 2: HOLD
fix         1 all temp/berendsen 8150.0 8150.0 100.0
run         100000
unfix       1

write_data 8150K.data
